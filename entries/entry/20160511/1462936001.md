---
Title: Rubyで指定文字の出現回数をカウントするときは注意が必要
Category:
- ruby
Date: 2016-05-11T12:06:41+09:00
URL: https://blog.turai.work/entry/20160511/1462936001
EditURL: https://blog.hatena.ne.jp/thr3a/thr3a.hatenablog.com/atom/entry/6653812171395524325
---

例えば以下の文章があったとする。

```
当職の弟を当職が殺したなどという当職のアイデンティティを否定する投稿が多数なされておりました。
当職の弟は厚史という名前でした。一つ違いの弟でした。喧嘩もしましたが、私にとってのかけがいのない弟でした。
弟は、地元の悪いもの達に、恐喝され、多摩川の河川敷で、集団暴行にあった翌日に親にもいえず自殺しました。
弟が16、私が17のことでした。
私の中にはいつも弟がいます。
```

この中から「**私**」が何回出現しているだろうか

```ruby
content = "当職の弟を当職が殺したなどという当職のアイデンティティを否定する投稿が多数なされておりました。
当職の弟は厚史という名前でした。一つ違いの弟でした。喧嘩もしましたが、私にとってのかけがいのない弟でした。
弟は、地元の悪いもの達に、恐喝され、多摩川の河川敷で、集団暴行にあった翌日に親にもいえず自殺しました。
弟が16、私が17のことでした。
私の中にはいつも弟がいます。
"

p content.count("私")
=> 3
```

なるほど、３回なり。

# 複数文字列のカウントはcount()でできない

じゃあ今度は「**当職**」を検索したい　ぱっと見て４個あるからおそらく４が返却されるはず

```ruby
p content.count("当職")
=> 8
```

これはおかしいですを。どうやら「当」と「職」に分けてそれぞれカウントしてしまっているらしい

# そんなときはscan()を使おう

```ruby
p content.scan("当職").length
```

これで完璧ナリ！
