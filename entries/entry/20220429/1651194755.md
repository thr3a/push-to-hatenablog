---
Title: Ubuntuã«MPDã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ãƒªãƒ¢ãƒ¼ãƒˆéŸ³æ¥½å†ç”Ÿã™ã‚‹
Category:
- ubuntu
Date: 2022-04-29T10:12:35+09:00
URL: https://blog.turai.work/entry/20220429/1651194755
EditURL: https://blog.hatena.ne.jp/thr3a/thr3a.hatenablog.com/atom/entry/13574176438087303142
---

# ç’°å¢ƒ

- Ubuntu 20.04
- mpd 0.23

# ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

æœ¬æ¥ã¯apt get install mpdã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã§ãã‚‹ãŒã€ãªã‚“ã‚„ã‹ã‚“ã‚„ãŒã‚ã£ã¦è‡ªå‰ãƒ“ãƒ«ãƒ‰ã—ãŸã‚‚ã®ã‚’ä½¿ã£ã¦ã„ã‚‹

[https://thr3a.hatenablog.com/entry/20220427/1651064636:embed:cite]

# è¨­å®š

```diff
# å†ç”Ÿã—ãŸã„éŸ³æ¥½ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹
-music_directory		"/var/lib/mpd/music"
+music_directory		"/mnt/nas/MUSIC"

# ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã ã¨ãƒ­ãƒ¼ã‚«ãƒ«ã§ã—ã‹é€šä¿¡ã§ããªã„ã®ã§anyã«ã—ã¦0.0.0.0ã«ã™ã‚‹
-bind_to_address		"localhost"
+bind_to_address		"any"

# ã‚¨ãƒ©ãƒ¼ã§ã†ã¾ãã„ã‹ãªã„ã¨ãã®èª¿æŸ»ç”¨
-#log_level			"default"
+log_level			"verbose"

# å¾Œè¿°ã™ã‚‹ãŒéŸ³æ¥½ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’è‡ªå‹•æ›´æ–°ã™ã‚‹ã‹
-#auto_update    "yes"
+auto_update    "yes"

# IPã‚¢ãƒ‰ãƒ¬ã‚¹ã¨ã‹æŒ‡å®šã—ãªãã¦ã‚‚ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ãŒè‡ªå‹•æ¤œå‡ºã—ã¦ãã‚Œã‚‹ã‚·ã‚¹ãƒ†ãƒ ã€€ãã‚Œãã‚‰ã„æ‰‹å‹•ã§ã‚„ã‚Œ
-#zeroconf_enabled		"yes"
+zeroconf_enabled		"no"

# exception: Decoder plugin 'wildmidi' is unavailable: configuration file does not exist: /etc/timidity/timidity.cfg
# ã®ã‚¨ãƒ©ãƒ¼ã§èµ·å‹•ã—ãªã‹ã£ãŸã®ã§å¯¾å¿œ
+decoder {
+	plugin "wildmidi"
+	enabled "no"
+}
+

# ã‚¹ãƒ”ãƒ¼ã‚«ãƒ¼å‡ºåŠ›ã¯ç„¡åŠ¹åŒ–
-audio_output {
-	type		"alsa"
-	name		"My ALSA Device"
+#audio_output {
+#	type		"alsa"
+#	name		"My ALSA Device"
 #	device		"hw:0,0"	# optional
 #	mixer_type      "hardware"      # optional
 #	mixer_device	"default"	# optional
 #	mixer_control	"PCM"		# optional
 #	mixer_index	"0"		# optional
-}
+#}

# mpd streamingæœ‰åŠ¹åŒ–
+audio_output {
+        type            "httpd"
+        name            "MPD Streaming"
+        encoder         "lame"          # optional, vorbis or lame
+        port            "6601"
+        bind_to_address "any"               # optional, IPv4 or IPv6
+#       quality         "5.0"                   # do not define if bitrate is defined
+        bitrate         "128"                   # do not define if quality is defined
+        format          "44100:16:1"
+        max_clients     "0"                     # optional 0=no limit
+        always_on "yes" # prevent MPD from disconnecting all listeners when playback is stopped
+        tags "yes" # httpd supports sending tags to listening streams.
+}
```

# èµ·å‹•

è¨­å®šåæ˜ 

```
systemctl restart mpd
```

è‡ªå‹•èµ·å‹•æœ‰åŠ¹åŒ–

```
systemctl enable mpd
```

# ã‚¨ãƒ©ãƒ¼å¯¾å¿œ

ã‚¨ãƒ©ãƒ¼ãƒ¬ãƒ™ãƒ«ã‚’verboseã«ã—ã¦ã«ã‚‰ã‚ã£ã“ã™ã‚‹ã—ã‹ãªã„

ã„ã¡ã„ã¡systemctlå†èµ·å‹•ã—ã¦ã‚‰ã‚Œã‚‹ã‹ã£ã¦å ´åˆã¯

```
# mpd --no-daemon --stdout --verbose /etc/mpd.conf
```

ã§ãƒ•ã‚©ã‚¢ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã§èµ·å‹•ã™ã‚‹ã¨ãƒ­ã‚°ãŒå…¨éƒ¨æ¨™æº–å‡ºåŠ›ã§æµã‚Œã‚‹ã®ã§ç¢ºèªã—ã‚„ã™ã„

### /var/lib/mpd/playlistsãŒãªã„

ä½•æ•…ã‹ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ä½œã‚‰ã‚Œã¦ãªã‹ã£ãŸ mpdãŒã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ãŸã‚ã«ã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼mpd ã‚°ãƒ«ãƒ¼ãƒ—audioã«ã™ã‚‹å¿…è¦ãŒã‚ã‚‹

```
# mkdir /var/lib/mpd/playlists
#chown mpd:audio /var/lib/mpd/playlists
```

### exception: Decoder plugin 'wildmidi' is unavailable

å‰è¿°ã—ãŸãŒwildmidiã¨ã‹ã„ã†ãƒ‡ã‚³ãƒ¼ãƒ€ãƒ¼ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãŒå‹æ‰‹ã«å¢—ãˆãŸãŒå¯¾å¿œã—ã¦ãªã„ã®ã§ã‚¨ãƒ©ãƒ¼ã€€ç„¡åŠ¹åŒ–ã—ãŸã‚‰èµ·å‹•ã—ãŸ

### Error â€œbind to â€˜0.0.0.0:6600â€™ failed (continuing anyway, because binding to â€˜[::]:6600â€™ succeeded)â€

çµè«–ã‹ã‚‰è¨€ã†ã¨ã€å•é¡Œãªã„

å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«ã‚‚

```
This happens on Linux when /proc/sys/net/ipv6/bindv6only is disabled. MPD first binds to IPv6, and this automatically binds to IPv4 as well; after that, MPD binds to IPv4, but that fails. You can safely ignore this, because MPD works on both IPv4 and IPv6.
```

ã£ã¦æ›¸ã„ã¦ã‚ã‚‹ã€‚ [https://mpd.readthedocs.io/en/latest/user.html#error-bind-to-0-0-0-0-6600-failed-continuing-anyway-because-binding-to-6600-succeeded](https://mpd.readthedocs.io/en/latest/user.html#error-bind-to-0-0-0-0-6600-failed-continuing-anyway-because-binding-to-6600-succeeded)

# å‚è€ƒãƒªãƒ³ã‚¯

- [MPDã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« - Open Audio Lab](https://www.openaudiolab.com/install-mpd/jp/)
- [MPD on Raspberry Pi ã§ãƒªãƒ¢ãƒ¼ãƒˆéŸ³æ¥½å†ç”Ÿç’°å¢ƒã‚’ä½œã‚‹ğŸ’ª](https://zenn.dev/aruneko/articles/9b4555b6dd3897)
- [MPD(Music Player Daemon) å‚™å¿˜éŒ²](https://www.labohyt.net/blog/server/post-927/)
- [Music Player Daemon - ArchWiki](https://wiki.archlinux.jp/index.php/Music_Player_Daemon)
- [Music Player Daemon/Troubleshooting - ArchWiki](https://wiki.archlinux.org/title/Music_Player_Daemon/Troubleshooting#Binding_to_IPV6_before_IPV4)
- [mpdèµ·å‹•ä¸­ã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒ2 - å‹ä¹‹ä»‹çš„ã¤ã¶ã‚„ããƒ–ãƒ­ã‚°](https://tomonosuke.hatenablog.jp/entry/2019/07/27/151217)
