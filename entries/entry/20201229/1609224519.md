---
Title: NFSマウント時の最強オプション晒す
Category:
- linux
Date: 2020-12-29T15:48:39+09:00
URL: https://blog.turai.work/entry/20201229/1609224519
EditURL: https://blog.hatena.ne.jp/thr3a/thr3a.hatenablog.com/atom/entry/26006613671389931
---

まあタイトルは嘘で、AWSとか大御書の推奨オプションをメモするだけ（

# AWS

```
rsize=1048576,wsize=1048576,hard,timeo=600,retrans=2,noresvport
```

[マウントに関する追加の考慮事項 - Amazon Elastic File System](https://docs.aws.amazon.com/ja_jp/efs/latest/ug/mounting-fs-mount-cmd-general.html)に記載されている。

- rsize=1048576 – 各ネットワーク読み取りリクエストに対して NFS クライアントが受信できるデータの最大バイト数を設定します。この値は、EFS ファイルシステム上のファイルからデータを読み取る際に適用されます。パフォーマンスが低下しないように、可能な限り大きいサイズ (最大 1048576) を使用することをお勧めします。
- wsize=1048576 – 各ネットワーク書き込みリクエストに対して NFS クライアントが送信できるデータの最大バイト数を設定します。この値は、EFS ファイルシステム上のファイルにデータを書き込む際に適用されます。パフォーマンスが低下しないように、可能な限り大きいサイズ (最大 1048576) を使用することをお勧めします。
- hard – NFS リクエストがタイムアウトした後の NFS クライアントのリカバリ動作を設定します。これにより、NFS リクエストは、サーバーが応答するまで無期限に再試行されます。データの整合性を確保できるように、ハードマウントオプション (hard) を使用することをお勧めします。soft マウントを使用している場合は、timeo パラメータを 150 デシ秒 (15 秒) 以上に設定してください。これにより、ソフトマウントに固有のデータ破損が生じるリスクを最小限に抑えることができます。
- timeo=600 – NFS クライアントがレスポンスを待機するのに要するタイムアウト値を設定してから、NFS リクエストを 600 デシ秒 (60 秒) に設定します。タイムアウトパラメータ (timeo) を変更する必要がある場合は、少なくとも 150 の値を使用することをお勧めします。これは 15 秒に相当します。これにより、パフォーマンスの低下を抑えることができます。
- retrans=2 – NFS クライアントでリカバリアクションを試行する前に、そのアクションのリクエスト試行回数を 2 回に設定します。
- noresvport – ネットワーク接続が再確立された時に、新しい Transmission Control Protocol (TCP) 送信元ポートを使用するように、NFS クライアントに指示します。これにより、ネットワーク復旧イベント後、EFS ファイルシステムでの中断のない可用性が保証されます。
- _netdev – /etc/fstab に存在する場合、クライアントは、ネットワークが有効になるまで、EFS ファイルシステムをマウントすることはできません。

# Alibaba Cloud

```
vers=4.0,rsize=1048576,wsize=1048576,hard,timeo=600,retrans=2,noresvport
```

[Linux で NFS ファイルシステムをマウントする - ファイルシステムのマウント| Alibaba Cloud ドキュメントセンター](https://jp.alibabacloud.com/help/doc-detail/90529.htm)

AWSとバージョンの指定有無しか違いなかった。もうこれで確定じゃん
